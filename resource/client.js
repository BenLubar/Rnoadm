'use strict';var p,q=this;function aa(a,c){var b=a.split("."),d=q;b[0]in d||!d.execScript||d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)b.length||void 0===c?d=d[e]?d[e]:d[e]={}:d[e]=c}
function r(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if("[object Window]"==b)return"object";if("[object Array]"==b||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==b||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==c&&"undefined"==typeof a.call)return"object";return c}function ba(a){var c=r(a);return"array"==c||"object"==c&&"number"==typeof a.length}function ca(a){return"string"==typeof a}function da(a){return a[fa]||(a[fa]=++ga)}var fa="closure_uid_"+(1E9*Math.random()>>>0),ga=0;function ha(a,c,b){return a.call.apply(a.bind,arguments)}
function ia(a,c,b){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(b,d);return a.apply(c,b)}}return function(){return a.apply(c,arguments)}}function s(a,c,b){s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return s.apply(null,arguments)}var ja=Date.now||function(){return+new Date};
function u(a,c){function b(){}b.prototype=c.prototype;a.J=c.prototype;a.prototype=new b};var ka="closure_listenable_"+(1E6*Math.random()|0);function la(a){try{return!(!a||!a[ka])}catch(c){return!1}}var ma=0;function na(a,c,b,d,e){this.m=a;this.H=null;this.src=c;this.type=b;this.capture=!!d;this.F=e;this.key=++ma;this.p=this.B=!1}function oa(a){a.p=!0;a.m=null;a.H=null;a.src=null;a.F=null};var pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function qa(a,c){for(var b,d,e=1;e<arguments.length;e++){d=arguments[e];for(b in d)a[b]=d[b];for(var f=0;f<pa.length;f++)b=pa[f],Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}};var v=Array.prototype,ra=v.indexOf?function(a,c,b){return v.indexOf.call(a,c,b)}:function(a,c,b){b=null==b?0:0>b?Math.max(0,a.length+b):b;if(ca(a))return ca(c)&&1==c.length?a.indexOf(c,b):-1;for(;b<a.length;b++)if(b in a&&a[b]===c)return b;return-1},ta=v.forEach?function(a,c,b){v.forEach.call(a,c,b)}:function(a,c,b){for(var d=a.length,e=ca(a)?a.split(""):a,f=0;f<d;f++)f in e&&c.call(b,e[f],f,a)};function ua(a){var c=a.length;if(0<c){for(var b=Array(c),d=0;d<c;d++)b[d]=a[d];return b}return[]};function va(a){this.src=a;this.b={};this.c=0}va.prototype.add=function(a,c,b,d,e){var f=this.b[a];f||(f=this.b[a]=[],this.c++);var g=wa(f,c,d,e);-1<g?(a=f[g],b||(a.B=!1)):(a=new na(c,this.src,a,!!d,e),a.B=b,f.push(a));return a};function xa(a,c){var b=c.type;if(b in a.b){var d=a.b[b],e=ra(d,c),f;(f=0<=e)&&v.splice.call(d,e,1);f&&(oa(c),0==a.b[b].length&&(delete a.b[b],a.c--))}}function wa(a,c,b,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.p&&f.m==c&&f.capture==!!b&&f.F==d)return e}return-1};var w,ya,za,Aa;function Ba(){return q.navigator?q.navigator.userAgent:null}Aa=za=ya=w=!1;var Ca;if(Ca=Ba()){var Da=q.navigator;w=0==Ca.lastIndexOf("Opera",0);ya=!w&&(-1!=Ca.indexOf("MSIE")||-1!=Ca.indexOf("Trident"));za=!w&&-1!=Ca.indexOf("WebKit");Aa=!w&&!za&&!ya&&"Gecko"==Da.product}var Ea=w,x=ya,y=Aa,Fa=za;function Ga(){var a=q.document;return a?a.documentMode:void 0}var Ha;
a:{var Ia="",Ja;if(Ea&&q.opera)var Ka=q.opera.version,Ia="function"==typeof Ka?Ka():Ka;else if(y?Ja=/rv\:([^\);]+)(\)|;)/:x?Ja=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Fa&&(Ja=/WebKit\/(\S+)/),Ja)var La=Ja.exec(Ba()),Ia=La?La[1]:"";if(x){var Ma=Ga();if(Ma>parseFloat(Ia)){Ha=String(Ma);break a}}Ha=Ia}var Na={};
function A(a){var c;if(!(c=Na[a])){c=0;for(var b=String(Ha).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(b.length,d.length),f=0;0==c&&f<e;f++){var g=b[f]||"",h=d[f]||"",k=/(\d*)(\D*)/g,l=/(\d*)(\D*)/g;do{var n=k.exec(g)||["","",""],m=l.exec(h)||["","",""];if(0==n[0].length&&0==m[0].length)break;c=((0==n[1].length?0:parseInt(n[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==n[1].length?0:parseInt(n[1],10))>(0==m[1].length?
0:parseInt(m[1],10))?1:0)||((0==n[2].length)<(0==m[2].length)?-1:(0==n[2].length)>(0==m[2].length)?1:0)||(n[2]<m[2]?-1:n[2]>m[2]?1:0)}while(0==c)}c=Na[a]=0<=c}return c}var Oa=q.document,Pa=Oa&&x?Ga()||("CSS1Compat"==Oa.compatMode?parseInt(Ha,10):5):void 0;var Qa=!x||x&&9<=Pa,Ra=x&&!A("9");!Fa||A("528");y&&A("1.9b")||x&&A("8")||Ea&&A("9.5")||Fa&&A("528");y&&!A("8")||x&&A("9");function B(){0!=Sa&&(Ta[da(this)]=this)}var Sa=0,Ta={};B.prototype.g=!1;B.prototype.M=function(){if(!this.g&&(this.g=!0,this.k(),0!=Sa)){var a=da(this);delete Ta[a]}};B.prototype.k=function(){if(this.o)for(;this.o.length;)this.o.shift()()};function C(a,c){this.type=a;this.b=this.q=c}C.prototype.M=function(){};C.prototype.c=!1;C.prototype.d=!0;C.prototype.preventDefault=function(){this.d=!1};function Ua(a){Ua[" "](a);return a}Ua[" "]=function(){};function Va(a,c){if(a){var b=this.type=a.type;C.call(this,b);this.q=a.target||a.srcElement;this.b=c;var d=a.relatedTarget;if(d&&y)try{Ua(d.nodeName)}catch(e){}this.offsetX=Fa||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=Fa||void 0!==a.offsetY?a.offsetY:a.layerY;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==b?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.Q=a;a.defaultPrevented&&this.preventDefault();delete this.c}}u(Va,C);p=Va.prototype;p.q=null;
p.offsetX=0;p.offsetY=0;p.keyCode=0;p.charCode=0;p.ctrlKey=!1;p.altKey=!1;p.Q=null;p.preventDefault=function(){Va.J.preventDefault.call(this);var a=this.Q;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ra)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Wa={},Xa={},D={};function Ya(a,c,b,d,e){if("array"==r(c))for(var f=0;f<c.length;f++)Ya(a,c[f],b,d,e);else if(b=Za(b),la(a))a.j.add(c,b,!1,d,e);else{f=b;if(!c)throw Error("Invalid event type");b=!!d;var g=da(a),h=Xa[g];h||(Xa[g]=h=new va(a));d=h.add(c,f,!1,d,e);d.H||(e=$a(),d.H=e,e.src=a,e.m=d,a.addEventListener?a.addEventListener(c,e,b):a.attachEvent(c in D?D[c]:D[c]="on"+c,e),Wa[d.key]=d)}}
function $a(){var a=cb,c=Qa?function(b){return a.call(c.src,c.m,b)}:function(b){b=a.call(c.src,c.m,b);if(!b)return b};return c}function db(a,c,b,d,e){if("array"==r(c))for(var f=0;f<c.length;f++)db(a,c[f],b,d,e);else(b=Za(b),la(a))?(a=a.j,c in a.b&&(f=a.b[c],b=wa(f,b,d,e),-1<b&&(oa(f[b]),v.splice.call(f,b,1),0==f.length&&(delete a.b[c],a.c--)))):a&&(d=!!d,a=eb(a))&&(c=a.b[c],a=-1,c&&(a=wa(c,b,d,e)),(b=-1<a?c[a]:null)&&fb(b))}
function fb(a){if("number"!=typeof a&&a&&!a.p){var c=a.src;if(la(c))xa(c.j,a);else{var b=a.type,d=a.H;c.removeEventListener?c.removeEventListener(b,d,a.capture):c.detachEvent&&c.detachEvent(b in D?D[b]:D[b]="on"+b,d);(b=eb(c))?(xa(b,a),0==b.c&&(b.src=null,delete Xa[da(c)])):oa(a);delete Wa[a.key]}}}function gb(a,c,b,d){var e=1;if(a=eb(a))if(c=a.b[c])for(c=ua(c),a=0;a<c.length;a++){var f=c[a];f&&f.capture==b&&!f.p&&(e&=!1!==hb(f,d))}return Boolean(e)}
function hb(a,c){var b=a.m,d=a.F||a.src;a.B&&fb(a);return b.call(d,c)}
function cb(a,c){if(a.p)return!0;if(!Qa){var b;if(!(b=c))a:{b=["window","event"];for(var d=q,e;e=b.shift();)if(null!=d[e])d=d[e];else{b=null;break a}b=d}e=b;b=new Va(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=b.b;f;f=f.parentNode)e.push(f);for(var f=a.type,h=e.length-1;!b.c&&0<=h;h--)b.b=e[h],d&=gb(e[h],f,!0,b);for(h=0;!b.c&&h<e.length;h++)b.b=e[h],d&=gb(e[h],f,!1,
b)}return d}return hb(a,new Va(c,this))}function eb(a){return a[fa]?Xa[da(a)]||null:null}var ib="__closure_events_fn_"+(1E9*Math.random()>>>0);function Za(a){return"function"==r(a)?a:a[ib]||(a[ib]=function(c){return a.handleEvent(c)})};var jb="StopIteration"in q?q.StopIteration:Error("StopIteration");function kb(){}kb.prototype.b=function(){throw jb;};kb.prototype.K=function(){return this};function lb(a){if(a instanceof kb)return a;if("function"==typeof a.K)return a.K(!1);if(ba(a)){var c=0,b=new kb;b.b=function(){for(;;){if(c>=a.length)throw jb;if(c in a)return a[c++];c++}};return b}throw Error("Not implemented");}
function mb(a,c){if(ba(a))try{ta(a,c,void 0)}catch(b){if(b!==jb)throw b;}else{a=lb(a);try{for(;;)c.call(void 0,a.b(),void 0,a)}catch(d){if(d!==jb)throw d;}}};function nb(a,c){this.l={};this.f=[];this.c=this.b=0;var b=arguments.length;if(1<b){if(b%2)throw Error("Uneven number of arguments");for(var d=0;d<b;d+=2)ob(this,arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof nb)for(d=pb(a),qb(a),e=[],b=0;b<a.f.length;b++)e.push(a.l[a.f[b]]);else{var b=[],f=0;for(d in a)b[f++]=d;d=b;b=[];f=0;for(e in a)b[f++]=a[e];e=b}for(b=0;b<d.length;b++)ob(this,d[b],e[b])}}function pb(a){qb(a);return a.f.concat()}
function qb(a){if(a.b!=a.f.length){for(var c=0,b=0;c<a.f.length;){var d=a.f[c];Object.prototype.hasOwnProperty.call(a.l,d)&&(a.f[b++]=d);c++}a.f.length=b}if(a.b!=a.f.length){for(var e={},b=c=0;c<a.f.length;)d=a.f[c],Object.prototype.hasOwnProperty.call(e,d)||(a.f[b++]=d,e[d]=1),c++;a.f.length=b}}function ob(a,c,b){Object.prototype.hasOwnProperty.call(a.l,c)||(a.b++,a.f.push(c),a.c++);a.l[c]=b}
nb.prototype.K=function(a){qb(this);var c=0,b=this.f,d=this.l,e=this.c,f=this,g=new kb;g.b=function(){for(;;){if(e!=f.c)throw Error("The map has changed since the iterator was created");if(c>=b.length)throw jb;var g=b[c++];return a?g:d[g]}};return g};function E(a,c){B.call(this);this.e=c;this.c=[];if(a>this.e)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var b=0;b<a;b++)this.c.push(this.b())}u(E,B);E.prototype.b=function(){return{}};E.prototype.d=function(a){var c=typeof a;if("object"==c&&null!=a||"function"==c)if("function"==r(a.M))a.M();else for(var b in a)delete a[b]};E.prototype.k=function(){E.J.k.call(this);for(var a=this.c;a.length;)this.d(a.pop());delete this.c};function rb(){this.c=[];this.e=new nb;this.b=new nb;this.o=1;this.g=new E(0,4E3);this.g.b=function(){return new sb};this.r=new E(0,50);this.r.b=function(){return new tb};var a=this;this.d=new E(0,2E3);this.d.b=function(){return String(a.o++)};this.d.d=function(){}}function tb(){this.time=this.count=0}tb.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function sb(){}
function ub(a,c,b){var d=[];-1==c?d.push("    "):d.push(vb(a.c-c));d.push(" ",wb(a.c-0));0==a.b?d.push(" Start        "):1==a.b?(d.push(" Done "),d.push(vb(a.g-a.startTime)," ms ")):d.push(" Comment      ");d.push(b,a);0<a.e&&d.push("[VarAlloc ",a.e,"] ");return d.join("")}sb.prototype.toString=function(){return null==this.type?this.d:"["+this.type+"] "+this.d};
rb.prototype.toString=function(){for(var a=[],c=-1,b=[],d=0;d<this.c.length;d++){var e=this.c[d];1==e.b&&b.pop();a.push(" ",ub(e,c,b.join("")));c=e.c;a.push("\n");0==e.b&&b.push("|  ")}if(0!=this.e.b){var f=ja();a.push(" Unstopped timers:\n");mb(this.e,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",wb(b.startTime),")\n")})}c=pb(this.b);for(d=0;d<c.length;d++)b=Object.prototype.hasOwnProperty.call(this.b.l,c[d])?this.b.l[c[d]]:void 0,1<b.count&&a.push(" TOTAL ",b,"\n");a.push("Total tracers created ",
0,"\n","Total comments created ",0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function vb(a){a=Math.round(a);var c="";1E3>a&&(c=" ");100>a&&(c="  ");10>a&&(c="   ");return c+a}function wb(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new rb;function F(){B.call(this);this.j=new va(this);this.r=this}u(F,B);F.prototype[ka]=!0;F.prototype.e=null;F.prototype.removeEventListener=function(a,c,b,d){db(this,a,c,b,d)};
function xb(a,c){var b,d=a.e;if(d)for(b=[];d;d=d.e)b.push(d);var d=a.r,e=c,f=e.type||e;if(ca(e))e=new C(e,d);else if(e instanceof C)e.q=e.q||d;else{var g=e,e=new C(f,d);qa(e,g)}var g=!0,h;if(b)for(var k=b.length-1;!e.c&&0<=k;k--)h=e.b=b[k],g=yb(h,f,!0,e)&&g;e.c||(h=e.b=d,g=yb(h,f,!0,e)&&g,e.c||(g=yb(h,f,!1,e)&&g));if(b)for(k=0;!e.c&&k<b.length;k++)h=e.b=b[k],g=yb(h,f,!1,e)&&g}
F.prototype.k=function(){F.J.k.call(this);if(this.j){var a=this.j,c=0,b;for(b in a.b){for(var d=a.b[b],e=0;e<d.length;e++)++c,oa(d[e]);delete a.b[b];a.c--}}this.e=null};function yb(a,c,b,d){c=a.j.b[c];if(!c)return!0;c=ua(c);for(var e=!0,f=0;f<c.length;++f){var g=c[f];if(g&&!g.p&&g.capture==b){var h=g.m,k=g.F||g.src;g.B&&xa(a.j,g);e=!1!==h.call(k,d)&&e}}return e&&!1!=d.d};function zb(a,c){F.call(this);this.W=void 0!==a?a:!0;this.c=c||Ab;this.d=this.c(this.u)}u(zb,F);p=zb.prototype;p.i=null;p.v=null;p.t=void 0;p.L=!1;p.u=0;function Ab(a){return Math.min(1E3*Math.pow(2,a),6E4)}p.V=function(a,c){null!=this.b&&q.clearTimeout(this.b);this.b=null;this.v=a;this.i=(this.t=c)?new WebSocket(this.v,this.t):new WebSocket(this.v);this.i.onopen=s(this.ba,this);this.i.onclose=s(this.Z,this);this.i.onmessage=s(this.aa,this);this.i.onerror=s(this.$,this)};
function Bb(a){null!=a.b&&q.clearTimeout(a.b);a.b=null;a.i&&(a.L=!0,a.i.close(),a.i=null)}p.ba=function(){xb(this,"d");this.u=0;this.d=this.c(this.u)};
p.Z=function(){xb(this,"a");this.i=null;if(this.L)this.v=null,this.t=void 0;else if(this.W){var a=s(this.V,this,this.v,this.t),c=this.d;if("function"==r(a))this&&(a=s(a,this));else if(a&&"function"==typeof a.handleEvent)a=s(a.handleEvent,a);else throw Error("Invalid listener argument");this.b=2147483647<c?-1:q.setTimeout(a,c||0);this.u++;this.d=this.c(this.u)}this.L=!1};p.aa=function(a){xb(this,new Cb(a.data))};p.$=function(a){xb(this,new Db(a.data))};p.k=function(){zb.J.k.call(this);Bb(this)};
function Cb(a){C.call(this,"c");this.message=a}u(Cb,C);function Db(a){C.call(this,"b");this.data=a}u(Db,C);var Eb=new zb,Fb=!1;function G(a){Fb&&(a=JSON.stringify(a),Eb.i.send(a))}Eb.V("wss://"+location.host+"/ws");Ya(Eb,"d",Gb);Ya(Eb,"a",Hb);Ya(Eb,"c",Ib);var Jb=[],Kb=[];function Gb(){Fb=!0;Jb.forEach(function(a){a()})}function Hb(){Fb=!1;Kb.forEach(function(a){a()})}var H={};function Ib(a){a=JSON.parse(a.message);var c,b;for(b in a)if(c=H[b])"Kick"==b&&Bb(Eb),c(a[b])};var I=document.createElement("canvas");aa("screenshot",function(){window.open(I.toDataURL())});var K=I.getContext("2d"),L=window.innerWidth,M=window.innerHeight;I.width=L;I.height=M;window.addEventListener("resize",function(){I.width=L=window.innerWidth;I.height=M=window.innerHeight;N()},!1);var Lb=Infinity,Mb=0;function N(a){a=!isNaN(a)&&0<a?a:0;var c=a+Date.now();Lb>c&&(Mb&&clearTimeout(Mb),Mb=setTimeout(function(){window.requestAnimationFrame(Nb);Mb=0;Lb=Infinity},a),Lb=c)}var Ob=!1;
Jb.push(function(){Ob=!0;N()});Kb.push(function(){Ob=!1;N()});
function Nb(){K.clearRect(0,0,L,M);if(Ob){for(var a=L,c=M,b=Pb(),d=Qb(),b=a/2/32-b,d=c/2/32-d,e=0;256>e;e+=16)for(var f=0;256>f;f+=16)Rb(Sb,b+e+8-0.5,d+f+16-1);for(var g=0;2>g;g++)for(Tb=!g,f=Math.max(0,Math.floor(-c/2-d));f<Math.min(256,Math.floor(c/2-d));f++){for(e=Math.max(0,Math.floor((-a/2-b)/2));e<Math.min(128,Math.floor((a/2-b)/2));e++){var h=O[e<<1|f<<8];if(h)for(var k in h)Ub(h[k],b,d)}for(e=Math.max(0,Math.floor((-a/2-b)/2));e<Math.min(128,Math.floor((a/2-b)/2));e++)if(h=O[e<<1|f<<8|1])for(k in h)Ub(h[k],
b,d)}Vb()}else P(Xb,L/2/32,M/2/32)}I.onmousemove=function(a){var c=a.offsetX||a.layerX;a=a.offsetY||a.layerY;var b=L,d=M;Yb(c,a,b,d)&&(a=c=-Infinity);Zb(c,a,b,d)};I.onmouseout=function(){var a=L,c=M;Yb(-Infinity,-Infinity,a,c);Zb(-Infinity,-Infinity,a,c)};var $b=!0;window.addEventListener("blur",function(){$b=!1},!1);window.addEventListener("focus",function(){setTimeout(function(){$b=!0},100)},!1);
I.onclick=function(a){if($b){var c=a.offsetX||a.layerX,b=a.offsetY||a.layerY,d=L;a=M;var e;a:if(Yb(c,b,d,a),ac)bc("inv"),e=!0;else{for(e=R.length-1;0<=e;e--)if(R[e].d(c,b,d,a)){e=!0;break a}e=!1}if(!(e||(d=d/2/32-Pb(),a=a/2/32-Qb(),c=Math.floor(c/32-d),b=Math.ceil(b/32-a),0>c||256<=c||0>b||256<=b))){a=[];for(var f in O[c|b<<8])"_"!=f.charAt(0)&&(d=O[c|b<<8][f],"_fl"!=d.c[0].c&&d.n.length&&a.unshift(d));a.length?G({Interact:{ID:a[0].id,X:a[0].x,Y:a[0].y,Action:a[0].n[0]}}):G({Walk:{X:c,Y:b}})}}else $b=
!0};I.oncontextmenu=function(a){a.preventDefault();$b=!0;var c=a.offsetX||a.layerX,b=a.offsetY||a.layerY,d=L;a=M;var e;a:{Yb(c,b,d,a);for(e=R.length-1;0<=e;e--)if(R[e].g(c,b,d,a)){e=!0;break a}e=!1}if(!(e||(d=d/2/32-Pb(),a=a/2/32-Qb(),c=Math.floor(c/32-d),b=Math.ceil(b/32-a),0>c||256<=c||0>b||256<=b))){a=[];for(var f in O[c|b<<8])"_"!=f.charAt(0)&&a.unshift(O[c|b<<8][f]);1==a.length?bc("menu",a[0]):a.length&&bc("menu2",a)}};function cc(a,c,b,d,e,f,g,h){function k(){function b(a,c){return e?a:128<=a?255-(255-a)*(255-c)/127:a*c/127}if(m.width&&m.height){l.width=m.width;l.height=m.height;var d=l.getContext("2d");a in S||(S[a]={});c in S[a]||(S[a][c]=[]);if(n in S[a][c])l.width*=n,l.height*=n,d.drawImage(S[a][c][n],0,0);else{S[a][c][n]=l;var e="no"==c;e&&(c="#000");d.fillStyle=c;d.fillRect(0,0,1,1);var f=d.getImageData(0,0,1,1),g=f.data[0],h=f.data[1],k=f.data[2],Dc=f.data[3];d.clearRect(0,0,1,1);d.drawImage(m,0,0);f=d.getImageData(0,
0,m.width,m.height);l.width*=n;l.height*=n;for(var sa=d.getImageData(0,0,l.width,l.height),Wb=0,Q=0,ea=0,ab=0;ab<l.height;ab++){for(var bb=0;bb<l.width;bb++)sa.data[ea+0]=b(f.data[Q+0],g),sa.data[ea+1]=b(f.data[Q+1],h),sa.data[ea+2]=b(f.data[Q+2],k),sa.data[ea+3]=f.data[Q+3]*Dc/255,bb%n==n-1&&(Q+=4),ea+=4;ab%n==n-1?Wb=Q:Q=Wb}d.putImageData(sa,0,0);N()}}}var l=document.createElement("canvas");this.g=l;this.c=b;this.o=d;this.r=e;this.e=f;this.d=g;var n=Math.floor(h)||1;this.b=n;var m;a+=".png";(m=dc[a])?
k():(m=new Image,m.onload=function(){dc[a]=m;k()},m.src=a)}var dc={},S={};
function Rb(a,c,b){function d(){K.drawImage(g.g,Math.floor(e*g.e*g.b),Math.floor(f*g.d*g.b),Math.floor(g.e*g.b),Math.floor(g.d*g.b),Math.floor(32*c-(g.e*g.b-32)/2),Math.floor(32*b-g.d*g.b),Math.floor(g.e*g.b),Math.floor(g.d*g.b))}var e=a.o,f=a.r,g=a;if(Tb)"_fl"==a.c&&(b+=0.5,d());else{switch(a.c){case "ccr":e+=[0,6,3,9][Math.floor(Date.now()/1500)%4];N(1500-Date.now()%1500);break;case "wa":e+=[0,1,0,2][Math.floor(Date.now()/150)%4];N(150-Date.now()%150);break;case "l2":e+=Math.floor(Date.now()/150)%
2;N(150-Date.now()%150);break;case "l3":e+=Math.floor(Date.now()/150)%3;N(150-Date.now()%150);break;case "_ac":if(2>f)break;a=Date.now()/1E4;switch(f){case 2:case 3:case 4:case 5:b+=Math.sin(5*a+7*Math.cos(3*a)+f)/8}N(100);break;case "wa_ac":e+=[0,1,0,2][Math.floor(Date.now()/150)%4];N(50);if(2>f)break;a=Date.now()/1E4;switch(f){case 2:case 3:case 4:case 5:b+=Math.sin(5*a+7*Math.cos(3*a)+f)/8}break;case "_fl":return}d()}}var Tb=!1;
function ec(a){return new cc(a.S,a.C,a.E.a||"",a.E.x||0,a.E.y||0,a.E.w||32,a.E.h||32,a.E.s||1)};function fc(a,c,b,d){this.id=b;this.d=this.x=a;this.e=this.y=c;this.b=0;this.name=d.N;var e=[];this.c=e;(d.S||[]).forEach(function(a){e.push(ec(a))});this.n=d.A||[]}function gc(a,c){a.name=c.N;a.n=c.A||[];var b=a.c;b.length=0;(c.S||[]).forEach(function(a){b.push(ec(a))})}function hc(a,c,b){a.d=ic(a.x,a.d,a.b);a.e=ic(a.y,a.e,a.b);a.x=c;a.y=b;a.b=Date.now()}function Ub(a,c,b){var d=ic(a.x,a.d,a.b),e=ic(a.y,a.e,a.b);a.c.forEach(function(a){Rb(a,d+c,e+b)})}
function ic(a,c,b){b=Date.now()-b;return 400>b?(N(),(b*a+(400-b)*c)/400):a};function T(a,c,b,d){this.b=a;this.g=c;this.d=b?1:0.5;this.c=32*this.d+"px "+(b?'"Jolly Lodger"':'"Open Sans Condensed"');this.e=!d}T.prototype.width=function(){K.font=this.c;return K.measureText(this.b).width/32};T.prototype.height=function(){return this.d};function P(a,c,b){K.font=a.c;var d=K.measureText(a.b).width;c=Math.floor(32*c-(a.e?d/2:0));b=Math.floor(32*b);K.fillStyle="rgba(0,0,0,.2)";for(d=-1;1>=d;d++)for(var e=-1;2>=e;e++)K.fillText(a.b,c+d,b+e);K.fillStyle=a.g;K.fillText(a.b,c,b)}
var Xb=new T("connection lost","#aaa",!0);function jc(a,c,b,d,e){this.c=a;this.e=c;this.b=b;this.d=d;this.g=e}
var R=[],kc=new T("Character","#ccc",!0),lc=new T("change name","#aaa",!1),mc=new T("change name","#fff",!1),nc=new T("change skin color","#aaa",!1),oc=new T("change skin color","#fff",!1),pc=new T("change shirt color","#aaa",!1),qc=new T("change shirt color","#fff",!1),rc=new T("change pants color","#aaa",!1),sc=new T("change pants color","#fff",!1),tc=new T("Confirm","#aaa",!0),uc=new T("Confirm","#fff",!0),vc=new T("[push enter to chat]","#ccc",!1,!0),U={};
function bc(a,c){var b=U[a](c||{});b.b(wc[0],wc[1],wc[2],wc[3]);var d=!1;R.forEach(function(c,f){if(c.c==a)return d=!0,R[f]=b,!1});d||R.push(b);N()}function V(a){R.forEach(function(c,b){if(c.c==a)return R.splice(b,1),N(),!1})}H.HUD=function(a){R.length=0;N();a.N.length&&bc(a.N,a.D)};var ac=!1,xc=new cc("ui_icons","no","",0,0,32,32),yc=new cc("ui_icons","#bbb","",0,0,32,32);
function Vb(){var a=L,c=M;null==W?P(vc,0.1,c/32-0.1):P(new T(W+"_","#fff",!1,!0),0.1,c/32-0.1);zc.forEach(function(a,d){P(a,0.1,c/32-d/2-0.6)});ac?Rb(yc,a/32-1,c/32):Rb(xc,a/32-1,c/32);R.forEach(function(b){b.e(a,c)})}var wc=[-Infinity,-Infinity,1,1];function Yb(a,c,b,d){wc=[a,c,b,d];if(a>=b-32&&a<=b&&c>=d-32&&c<=d)return ac||(ac=!0,N()),!0;ac&&(ac=!1,N());for(var e=R.length-1;0<=e;e--)if(R[e].b(a,c,b,d))return!0;return!1}
window.addEventListener("keydown",function(a){if(I.parentNode&&!a.ctrlKey&&!a.altKey)switch(20>a.keyCode&&a.preventDefault(),a.keyCode){case 8:null!==W&&0<W.length&&(W=W.substring(0,W.length-1),N());break;case 13:null===W?W="":(G({Chat:W}),W=null);N();break;case 27:null!==W&&(W=null,N())}},!1);window.addEventListener("keypress",function(a){null!==W&&(W+=String.fromCharCode(a.charCode),N())},!1);Jb.push(function(){W=null});var W=null,zc=[];
H.Msg=function(a){a.forEach(function(a){zc.unshift(new T(a.T,a.C,!1,!0));window.console.log(a.T);window.setTimeout(function(){zc.pop()},6E4);N()})};var X=[];H.Inventory=function(a){var c={};X.forEach(function(a){c[a.id]=a});X.length=0;a.forEach(function(a,d){var e=c[a.I];e?(gc(e,a.O),hc(e,d%8,Math.floor(d/8))):e=new fc(d%8,Math.floor(d/8),a.I,a.O);X.push(e)});N()};var Y=window.sessionStorage.rnoadm_username||"",Z=window.sessionStorage.rnoadm_password||"",$=document.querySelector("form"),Ac=$.querySelector("#username"),Bc=$.querySelector("#password"),Cc=$.querySelector("#password2");Jb.push(function(){Y.length&&2<Z.length&&(Ac.value=Y,Bc.value=Z,Cc.value=Z,$.onsubmit())});aa("admin",function(a){G({Admin:[].slice.call(arguments).map(String)})});Bc.onchange=function(){Cc.value=Bc.value};
$.onsubmit=function(){Y=Ac.value;Z=Bc.value;if(Y.length)if(2>=Z.length)Y=Z="",Bc.focus();else{window.sessionStorage.rnoadm_username=Y;window.sessionStorage.rnoadm_password=Z;G({Auth:{U:Y,P:Z}});var a=$.parentNode;a&&(a.removeChild($),a.style.overflow="hidden",a.style.fontSize="0",a.appendChild(I))}else Y=Z="",Ac.focus()};H.Kick=function(a){window.sessionStorage.rnoadm_username=Y="";window.sessionStorage.rnoadm_password=Z="";alert(a)};var O=Array(65536);H.Update=function(a){a.forEach(function(a){var b=a.I,d=a.X,e=a.Y,f=a.Fx,g=a.Fy,h=a.R,k=a.O;a=d|e<<8;O[a]||(O[a]={});h?(delete O[a][b],N()):void 0!==k?b in O[a]?gc(O[a][b],k):O[a][b]=new fc(d,e,b,k):(f|=g<<8,O[a][b]=O[f][b],delete O[f][b],hc(O[a][b],d,e))});N()};var Ec=0,Fc=127,Gc=127;H.PlayerX=function(a){Gc!=a&&(Fc=Pb(),Gc=a,Ec=Date.now(),N())};function Pb(){return ic(Gc,Fc,Ec)}var Hc=0,Ic=127,Jc=127;H.PlayerY=function(a){Jc!=a&&(Ic=Qb(),Jc=a,Hc=Date.now(),N())};
function Qb(){return ic(Jc,Ic,Hc)}Kb.push(function(){for(var a=0;a<O.length;a++)delete O[a]});var Sb=new cc("grass","#268f1e","",0,0,512,512),Kc=-1,Lc=-1;
function Zb(a,c,b,d){b=b/2/32-Pb();d=d/2/32-Qb();a=Math.floor(a/32-b);c=Math.ceil(c/32-d);if(a!=Kc||c!=Lc)if(I.style.cursor="",!(0>a||255<a||0>c||255<c)){d="";for(var e in O[a|c<<8])"_"!=e.charAt(0)&&(b=O[a|c<<8][e],"_fl"!=b.c[0].c&&b.n.length&&(d=b.n[0]));d&&(I.style.cursor="url(cursor_"+d+".png),auto");-1==Kc&&(Kc=a,Lc=c);G({Mouse:{Fx:Kc,Fy:Lc,X:a,Y:c}});Kc=a;Lc=c}};new function(){ja()};!y&&!x||x&&x&&9<=Pa||y&&A("1.9.1");x&&A("9");var Mc;
U.cc=function(a){var c=[];a.S.forEach(function(a){c.push(ec(a))});var b=new T(a.N,"#aaa",!0),d=new T(a.N,"#fff",!0),e=new T("change gender ("+a.G+")","#aaa",!1),f=new T("change gender ("+a.G+")","#fff",!1),g=!1,h=!1,k=!1,l=!1,n=!1,m=!1,z=!0;return new jc("cc",function(a,t){K.fillStyle="rgba(0,0,0,.7)";K.fillRect(0,0,a,t);a/=64;t/=64;c.forEach(function(b){Rb(b,a-3,t+1)});P(kc,a+2,t-4);g?(P(d,a,t+2),P(mc,a,t+2.5)):(P(b,a,t+2),P(lc,a,t+2.5));h?P(f,a+2,t-3):P(e,a+2,t-3);k?P(oc,a+2,t-2):P(nc,a+2,t-2);
l?P(qc,a+2,t-1):P(pc,a+2,t-1);n?P(sc,a+2,t):P(rc,a+2,t);m?P(uc,a,t+4):P(tc,a,t+4)},function(a,c,d,f){a/=32;c/=32;d/=64;f/=64;c>=f+2-b.height()&&c<=f+2.5&&Math.abs(d-a)<=Math.max(b.width(),lc.width())/2?(g||N(),g=!0,z=m=n=l=k=h=!1):c>=f-3-e.height()&&c<=f-3&&Math.abs(d+2-a)<=e.width()/2?(h||N(),g=!1,h=!0,z=m=n=l=k=!1):c>=f-2-nc.height()&&c<=f-2&&Math.abs(d+2-a)<=nc.width()/2?(k||N(),h=g=!1,k=!0,z=m=n=l=!1):c>=f-1-pc.height()&&c<=f-1&&Math.abs(d+2-a)<=pc.width()/2?(l||N(),k=h=g=!1,l=!0,z=m=n=!1):c>=
f-rc.height()&&c<=f&&Math.abs(d+2-a)<=rc.width()/2?(n||N(),l=k=h=g=!1,n=!0,z=m=!1):c>=f+4-tc.height()&&c<=f+4&&Math.abs(d-a)<=tc.width()/2?(m||N(),n=l=k=h=g=!1,m=!0,z=!1):(z||N(),m=n=l=k=h=g=!1,z=!0);return!0},function(){switch(!0){case g:G({HUD:{N:"cc",D:"name"}});break;case h:G({HUD:{N:"cc",D:"gender"}});break;case k:G({HUD:{N:"cc",D:"skin"}});break;case l:G({HUD:{N:"cc",D:"shirt"}});break;case n:G({HUD:{N:"cc",D:"pants"}});break;case m:G({HUD:{N:"cc",D:"accept"}})}return!0},function(){return!0})};
U.examine=function(a){var c=new T(a.N,"#ccc",!0,!0),b=new T(a.E,"#ccc",!1,!0),d=[];(a.I||[]).forEach(function(a){var b=[];d.push(b);a.forEach(function(a){b.push(new T(a[0],a[1],!1,!0))})});return new jc("examine",function(a,f){K.fillStyle="rgba(0,0,0,.7)";K.fillRect(0,0,a,f);var g=a/2/32-6,h=f/2/32-6;P(c,g,h);h+=0.5;P(b,g,h);h+=1;d.forEach(function(b){g=a/2/32-6;b.forEach(function(a){P(a,g,h);g+=a.width()});h+=0.5})},function(){return!0},function(){V("examine");return!0},function(){V("examine");return!0})};
U.forge=function(){var a=new cc("forge","#888","",0,0,64,32),c=new T("Forge","#ccc",!0);return new jc("forge",function(b,d){K.fillStyle="rgba(0,0,0,.7)";K.fillRect(b/2-240,d/2-192,512,384);K.fillStyle="#000";K.fillRect(b/2-240,d/2-192,512,32);var e=b/32/2,f=d/32/2;Rb(a,e-7,f-5);P(c,e+1,f-5)},function(a,c,e,f){return 7.5<Math.abs(a/32-e/32/2)||6<Math.abs(c/32-f/32/2)?!1:!0},function(a,c,e,f){return 7.5<Math.abs(a/32-e/32/2)||6<Math.abs(c/32-f/32/2)?(V("forge"),!1):!0},function(a,c,e,f){return 7.5<
Math.abs(a/32-e/32/2)||6<Math.abs(c/32-f/32/2)?(V("forge"),!1):!0})};
U.inv=function(){var a=-1,c=-1,b=-Infinity,d=-Infinity;return new jc("inv",function(e,f){var g=Math.ceil(X.length/8),h=e/32-8.1,k=f/32-0.1-g;K.fillStyle="rgba(0,0,0,.7)";K.fillRect(e-262.4,f-32*(g+1.2),262.4,32*(g+0.2));X.forEach(function(a){Ub(a,h,k)});if(0<=a&&8>a&&0<=c&&c<g&&a+8*c<X.length){var g=new T(X[a+8*c].name,"#fff",!1,!0),l=32*(g.width()+0.2),n=32*(g.height()+0.2);K.fillStyle="rgba(0,0,0,.7)";K.fillRect(b-l,d,l,n);P(g,b/32-g.width()-0.1,d/32+g.height()+0.1)}},function(e,f,g,h){var k=Math.ceil(X.length/
8);b=e;d=f;a=Math.floor((e-g)/32+8.1);c=Math.floor((f-h)/32+k+1.1);N();if(c>k||-1>a)V("inv");else return!0},function(){return!0},function(){var b=Math.ceil(X.length/8);0<=a&&8>a&&0<=c&&c<b&&a+8*c<X.length&&bc("menu",X[a+8*c])})};
U.menu=function(a){var c=-1,b=null,d=null,e=!1,f=[],g=[],h=a.n;h.forEach(function(b){b=b+" "+a.name;f.push(new T(b,"#aaa",!1,!0));g.push(new T(b,"#fff",!1,!0))});var k=-2;f.forEach(function(a){k=Math.max(a.width(),k)});var k=32*(k+0.2),l=Math.floor(32*(h.length/2+0.2));return new jc("menu",function(a,m){e&&(e=!1,b+k>a&&(b=a-k),d+l>m&&(d=m-l));K.fillStyle="rgba(0,0,0,.7)";K.fillRect(b||0,d||0,k,l);-1!=c&&(K.fillStyle="#000",K.fillRect(b||0,(d||0)+32*(c/2+0.1),k,16));for(var z=b/32+0.1,J=d/32+0.5,t=
0;t<h.length;t++)t==c?P(g[t],z,J+t/2):P(f[t],z,J+t/2)},function(a,f){null===b&&(b=a,d=f,e=!0,N());a>=b&&a<b+k&&f>=Math.floor(d+3.2)&&f<Math.floor(d+32*(h.length/2+0.1))?(c=Math.floor(2*(f-d)/32-0.1),c>=h.length&&(c=-1)):(c=-1,(a<b-32||a>b+k+32||f<Math.floor(d-32)||f>d+l+32)&&V("menu"));N();return!0},function(){-1!=c&&G({Interact:{ID:a.id,X:a.x,Y:a.y,Action:h[c]}});V("menu");return!0},function(){V("menu");return!0})};
U.menu2=function(a){var c=-1,b=null,d=null,e=!1,f=[],g=[];a.forEach(function(a){a=a.name;f.push(new T(a,"#aaa",!1,!0));g.push(new T(a,"#fff",!1,!0))});var h=-2;f.forEach(function(a){h=Math.max(a.width(),h)});var h=32*(h+0.2),k=Math.floor(32*(a.length/2+0.2));return new jc("menu2",function(l,n){e&&(e=!1,b+h>l&&(b=l-h),d+k>n&&(d=n-k));K.fillStyle="rgba(0,0,0,.7)";K.fillRect(b||0,d||0,h,k);-1!=c&&(K.fillStyle="#000",K.fillRect(b||0,(d||0)+32*(c/2+0.1),h,16));for(var m=b/32+0.1,z=d/32+0.5,J=0;J<a.length;J++)J==
c?P(g[J],m,z+J/2):P(f[J],m,z+J/2)},function(f,g){null===b&&(b=f,d=g,e=!0,N());f>=b&&f<b+h&&g>=Math.floor(d+3.2)&&g<d+Math.floor(32*(a.length/2+0.1))?(c=Math.floor(2*(g-d)/32-0.1),c>=a.length&&(c=-1)):(c=-1,(f<b-32||f>b+h+32||g<d-32||g>d+k+32)&&V("menu2"));N();return!0},function(){-1!=c&&bc("menu",a[c]);V("menu2");return!0},function(){V("menu2");return!0})};H.ClientHash=function(a){void 0!==Mc?Mc!=a&&location.reload(!0):Mc=a};
